// script.min.js - JavaScript otimizado (~5KB)
const GAS_URL='https://script.google.com/macros/s/AKfycbxj7ibzOEaJLlea_XSzqRaXbGQnSiNmCfqU7C86Oo6n1kS0REfD5-lgXCuRWPdYxplwKw/exec';
const estadosBrasil=[{sigla:'AC',nome:'Acre'},{sigla:'AL',nome:'Alagoas'},{sigla:'AP',nome:'Amapá'},{sigla:'AM',nome:'Amazonas'},{sigla:'BA',nome:'Bahia'},{sigla:'CE',nome:'Ceará'},{sigla:'DF',nome:'Distrito Federal'},{sigla:'ES',nome:'Espírito Santo'},{sigla:'GO',nome:'Goiás'},{sigla:'MA',nome:'Maranhão'},{sigla:'MT',nome:'Mato Grosso'},{sigla:'MS',nome:'Mato Grosso do Sul'},{sigla:'MG',nome:'Minas Gerais'},{sigla:'PA',nome:'Pará'},{sigla:'PB',nome:'Paraíba'},{sigla:'PR',nome:'Paraná'},{sigla:'PE',nome:'Pernambuco'},{sigla:'PI',nome:'Piauí'},{sigla:'RJ',nome:'Rio de Janeiro'},{sigla:'RN',nome:'Rio Grande do Norte'},{sigla:'RS',nome:'Rio Grande do Sul'},{sigla:'RO',nome:'Rondônia'},{sigla:'RR',nome:'Roraima'},{sigla:'SC',nome:'Santa Catarina'},{sigla:'SP',nome:'São Paulo'},{sigla:'SE',nome:'Sergipe'},{sigla:'TO',nome:'Tocantins'}];

function init(){headerScroll();mobileMenu();smoothScroll();initFilter();initForm();}
function headerScroll(){window.addEventListener('scroll',()=>{const h=document.getElementById('header');h.classList.toggle('scrolled',window.scrollY>100)})}
function mobileMenu(){const t=document.getElementById('mobileToggle'),n=document.getElementById('navMenu');t&&t.addEventListener('click',()=>{n.classList.toggle('active');t.innerHTML=n.classList.contains('active')?'<i class="fas fa-times"></i>':'<i class="fas fa-bars"></i>'})}
function smoothScroll(){document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener('click',function(e){const t=this.getAttribute('href');if(t==='#')return;const e2=document.querySelector(t);e2&&window.scrollTo({top:e2.offsetTop-80,behavior:'smooth'})})})}
function initFilter(){const b=document.querySelectorAll('.filter-btn'),c=document.querySelectorAll('.client-card');b.forEach(btn=>{btn.addEventListener('click',function(){b.forEach(b=>b.classList.remove('active'));this.classList.add('active');const f=this.getAttribute('data-filter');c.forEach(card=>{if(f==='all'||card.getAttribute('data-category').includes(f)){card.style.display='block';setTimeout(()=>{card.style.opacity='1';card.style.transform='scale(1)'},10)}else{card.style.opacity='0';card.style.transform='scale(0.8)';setTimeout(()=>{card.style.display='none'},300)}})})})}
async function carregarCidades(e){const c=document.getElementById('city');c.innerHTML='<option value="">Carregando cidades...</option>';c.disabled=true;try{const r=await fetch(`https://servicodados.ibge.gov.br/api/v1/localidades/estados/${e}/municipios`),d=await r.json();c.innerHTML='<option value="">Selecione sua cidade</option>';d.forEach(ct=>{const o=document.createElement('option');o.value=ct.nome;o.textContent=ct.nome;c.appendChild(o)});c.disabled=false}catch(e){console.error('Erro:',e);c.innerHTML='<option value="">Digite manualmente</option>';c.disabled=false}}
function initForm(){const s=document.getElementById('state'),a=document.getElementById('age'),c=document.getElementById('condition'),o=document.getElementById('outraCondicaoContainer'),i=document.getElementById('outraCondicao');estadosBrasil.forEach(e=>{const o=document.createElement('option');o.value=e.sigla;o.textContent=e.nome;s.appendChild(o)});s.addEventListener('change',function(){this.value?carregarCidades(this.value):(cidadeSelect.innerHTML='<option value="">Selecione estado primeiro</option>',cidadeSelect.disabled=true)});for(let i=16;i<=120;i++){const o=document.createElement('option');o.value=i;o.textContent=i+' anos';a.appendChild(o)}c.addEventListener('change',function(){if(this.value==='outra'){o.style.display='block';i.required=true}else{o.style.display='none';i.required=false;i.value=''}});const p=document.getElementById('phone');p.addEventListener('input',function(e){let v=e.target.value.replace(/\D/g,'');if(v.length>11)v=v.substring(0,11);if(v.length>10)e.target.value=`(${v.substring(0,2)}) ${v.substring(2,7)}-${v.substring(7,11)}`;else if(v.length>6)e.target.value=`(${v.substring(0,2)}) ${v.substring(2,6)}-${v.substring(6,10)}`;else if(v.length>2)e.target.value=`(${v.substring(0,2)}) ${v.substring(2)}`;else if(v.length>0)e.target.value=`(${v}`});const f=document.getElementById('contactForm'),fs=document.getElementById('formStatus');f.addEventListener('submit',async function(e){e.preventDefault();const cs=c.value,ov=i?i.value.trim():'';if(!cs){showFieldError(c,'Selecione uma condição de saúde');c.focus();c.scrollIntoView({behavior:'smooth',block:'center'});return}if(cs==='outra'&&!ov){showFieldError(i,'Descreva sua condição');i.focus();i.scrollIntoView({behavior:'smooth',block:'center'});return}const fd={timestamp:new Date().toLocaleString('pt-BR'),name:document.getElementById('name').value.trim(),phone:p.value.trim(),email:document.getElementById('email').value.trim()||'Não informado',age:a.value,state:s.value,city:document.getElementById('city').value.trim(),condition:cs==='outra'?ov:c.options[c.selectedIndex].text,message:document.getElementById('message').value.trim()||'Não informada',source:'Site Ozoxx',page_url:window.location.href},b=this.querySelector('button[type="submit"]'),ot=b.innerHTML;b.innerHTML='<i class="fas fa-spinner fa-spin"></i> Enviando...';b.disabled=true;fs.style.display='none';try{await fetch(GAS_URL,{method:'POST',mode:'no-cors',headers:{'Content-Type':'application/json'},body:JSON.stringify(fd)});showSuccessMessage();f.reset();o.style.display='none';i.value=''}catch(e){showErrorMessage();console.error('Erro:',e)}b.innerHTML=ot;b.disabled=false})}
function showSuccessMessage(){const fs=document.getElementById('formStatus');fs.className='form-status success';fs.innerHTML='<i class="fas fa-check-circle"></i> <strong>Sucesso!</strong><br>Solicitação realizada. Entraremos em contato em até 24 horas.';fs.style.display='block';fs.scrollIntoView({behavior:'smooth',block:'center'})}
function showErrorMessage(){const fs=document.getElementById('formStatus');fs.className='form-status error';fs.innerHTML='<i class="fas fa-exclamation-triangle"></i> <strong>Erro ao enviar.</strong><br>Tente novamente ou entre em contato pelo WhatsApp.';fs.style.display='block';fs.scrollIntoView({behavior:'smooth',block:'center'})}
function showFieldError(f,m){let e=f.parentNode.querySelector('.field-error');if(!e){e=document.createElement('div');e.className='field-error';e.style.color='var(--danger)';e.style.fontSize='.85rem';e.style.marginTop='5px';f.parentNode.appendChild(e)}e.textContent=m}
function clearFieldError(f){const e=f.parentNode.querySelector('.field-error');e&&e.remove()}
document.addEventListener('DOMContentLoaded',()=>{init();if(GAS_URL.includes('YOUR_SCRIPT_ID'))console.warn('Configure a URL do Google Apps Script')});
